# MAA 사용자 설명서

## 기능

### 원클릭 이성 활용

- 스테이지 자동 선택이 필요 없다면 MAA에서 `현재/최근`을 선택하고 게임에서 수동으로 스테이지를 찾아 **작전개시** 버튼과 **대리지휘** 버튼이 표시되는 화면으로 이동해 주세요.
  - 해당 화면이 아닐 경우 `현재/최근`은 게임의 “지난 전투”를 선택하게 됩니다. (작전 메인 페이지의 우측 하단에 있는 기록에 따라 다름)
  - `작업 설정`-`이성 사용`에서 `스테이지 코드 수동 입력`을 활성화해 드롭다운 목록에서 스테이지를 선택하는 대신 코드를 직접 입력할 수도 있습니다. (예시: `1-7`, `S3-2`, `CE-6` 등)

<details><summary>예시 보기</summary>

![예시 보기](https://user-images.githubusercontent.com/5153875/196309375-73a93b83-e59b-441c-913f-122d4a9fc46c.png)

</details>

- `이성 회복제 + 순오리지늄`, `횟수 제한`, `드롭 제한` 스위치는 3개입니다. 이 중 하나에 도달하면 작업이 완료된 것으로 처리되며 작전이 중지됩니다.
  - 其中：
    - `이성 회복제` 정신건강약 사용 수량 제한 (한 번에 여러 병을 사용할 수 있습니다.)
    - `순오리지늄` 사용 횟수 (1회당 1개). 이성 회복을 위해 근원석을 사용할 때, 이성 포션이 남아 있다면 해당 돌은 사용되지 않습니다.
    - `횟수 제한` 스테이지를 플레이할 횟수를 지정합니다. (예시: 15회 플레이 후 중지)
    - `드롭 제한` 지정된 재료의 드롭 수를 지정합니다. (예시: 5개의 원암 드롭 후 중지)

| 예 | 회복제 | 오리지늄 | 횟수 제한 | 드롭 제한 | 설명果                                                                                                                                                                     |
| :-: | :----: | :------: | :-------: | :--------: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| A |  999  |    10    |     1     |     ✖     | 이성 회복제/순오리지늄을 **1회** 이상 사용하고 `횟수 제한:1`이 충족되면 즉시 종료됩니다. 이성, 이성 회복제, 순오리지늄이 전부 부족하다면 바로 종료됩니다.           |
| B |   x   |    x    |    100    |     ✖     | 100회 시행하는 것으로 되어 있지만, 현재 가지고 있는 이성을 전부 소모하면 `이성 회복제`나 `순오리지늄`을 사용할 수 없어 이성이 부족해 종료됩니다.                       |
| C |   1   |    x    |    100    |     ✖     | 100회 시행하는 것으로 되어 있지만, 이성 회복제를 1번 사용한 후에는 현재 가지고 있는 이성을 전부 소모하면 `이성 회복제: 1`과 `순오리지늄: 0`에 도달했으므로 종료됩니다. |
| D |  999  |    ✖    |    100    | 3원암 큐브 | 100회 시행하며 최대 999개의 이성 회복제를 사용하는 것으로 되어 있지만, 시행 중 3개의 원암 큐브를 얻으면 `드롭 제한:원암 큐브 3개`에 도달했으므로 종료됩니다.             |

- `드롭 제한`과 `스테이지 선택`은 연관되어 있지 않습니다.
  - `드롭 제한`은 재료의 개수를 기준으로 작업을 종료하는 스위치일 뿐 재료를 지정한다고 해서 스테이지를 자동으로 설정해주는 것은 아닙니다.
- `대리지휘`를 체크하는 것을 깜빡해 벌어지는 참사가 일어나지 않도록 자동으로 체크해 드립니다~
- 재료 드롭을 식별하고 표시하며, [펭귄 물류](https://penguin-stats.io/)에 자동으로 업로드하고 사용자 ID를 설정할 수 있습니다.
- 연결이 끊어진 후 또는 새벽 4시에 끊어진 후 자동으로 재연결되어 게임에서 마지막으로 선택한 스테이지를 계속해서 플레이할 수 있습니다. 다음 날로 넘어가려면 마지막 스테이지 선택을 확인하세요.
- 전권 위임을 통한 섬멸 작전 자동화를 지원합니다.
- 대리 지휘가 실패할 경우 자동으로 작전을 포기하고 메인 화면으로 돌아갑니다.
- 이성 완전 소모를 지원합니다.
  - 주 작업을 완료한 이후, 자동으로 지정된 스테이지로 이동해 남은 '잉여' 이성을 소모합니다. (예시: 1-7에서의 남은 이성 소모)
  - 남은 이성이 지정된 스테이지를 클리어하기에 부족한 경우(예시: 1-7이 지정되어 있으나 이성이 6보다 적은 경우), 작업은 즉시 종료됩니다.

### 원클릭 기반시설

#### 오퍼레이터 교대 전략

**단일 시설 내에서의 최적의 방안**을 자동으로 계산해 골라냅니다. 모든 일반/특수 스킬 조합을 지원합니다. 서로 다른 오퍼레이터들의 작전기록, 순금, 오리지늄 조각, 칩 등을 인식합니다.

#### 기반시설 컨디션 한계치

컨디션의 비율을 감지합니다. 컨디션이 일정 수치 이하로 떨어질 경우, 오퍼레이터를 숙소로 이동시킵니다.

#### 주의사항

- 교대 전략은 다중 시설이 아닌 단일 시설 내에서의 최적의 방안을 바탕으로 합니다. 단일 시설 내의 `샤마르-테킬라` 조합, `버메일-씬` 조합 등은 제대로 인식되지만 `로즈몬티스`나 `피누스 실베스트리스` 등의 다중 시설간 조합은 아직 지원되지 않습니다.
- 만약 다중 시설간 조합을 원할 경우, `커스텀 기반시설`을 이용하세요.
- `드론 사용처`가 `무역소-용문폐`로 지정되어 있을 경우, `샤마르`를 인식하고 드론을 아껴둘 것입니다.
- 응접실에서 단 한 종류의 단서가 부족하다면 해당 진영의 오퍼레이터가 선택됩니다. 그렇지 않은 경우 일반적인 오퍼레이터가 선택됩니다.
- 응접실이 꽉 차 있을 때만 단서를 내보낼 것입니다. 최대 3개의 단서가 전달됩니다. `resource/tasks.json`에서 `SelectClue`-`maxTimes` 필드를 수정해 단서의 전달 개수를 조절할 수 있습니다.
- `아이린`이나 다른 오퍼레이터가 당장 업무 중이 아니라는 이유로 숙소로 보내지는 것을 원치 않는다면, `이미 배치된 오퍼레이터를 숙소에 넣지 않기` 옵션을 활성화할 수 있습니다. 단, 컨디션이 0이 아닌 한 어떤 오퍼레이터도 숙소로 들어오지 못하게 되는 문제를 불러올 수도 있습니다.
- 제어 센터의 복잡성으로 인해서, `아미야`, `스와이어`, `켈시`, `레인보우 팀`과 기타 시간당 컨디션 +0.05 오퍼레이터만이 고려됩니다. 미래에 개선될 예정입니다.
- 몇몇 이격 오퍼레이터로 인한 충돌이 발생할 수 있습니다. UI에 오퍼레이터 충돌 경고가 있는지 확인하시고, 경고가 있다면 기반시설의 상태를 수동으로 확인하여 적절하게 배치해 주세요. (예시: 특정 시설이 완전히 비어 있을 수 있음)

### 공개모집 인식

- 자동 공개모집과 공개모집 인식은 서로 다른 기능입니다!
- 자동 공개모집의 경우 `즉시 완료 허가증` 사용을 통한 완전 자동화를 지원합니다! 설정에서 변경 가능합니다.
- ★5/★6 오퍼레이터가 모집되면 팝업 알림이 뜹니다.
- 자동 공개모집 중 공개모집 데이터를 [펭귄 물류](https://penguin-stats.io/)와 [Yituliu](https://ark.yituliu.cn/)로 자동으로 전송합니다.

### 통합전략 지원

- MAA 설정에서 `팬텀/미즈키` 테마를 선택하고, 해당 테마를 게임 내에서 "고정시켜" 주세요. 그렇지 않으면 최신 테마가 표시되어 문제가 발생할 수 있습니다.
  - 고정시키지 않는 경우 기능 가동 전에 해당 테마의 메인 화면(탐색 시작/탐색 계속 버튼 표시)인지 확인해 주세요.
  - 설정과 다른 테마의 진행 중인 탐험이 있을 경우 수동으로 종료하고 진행해 주세요.

<details><summary>고정 방법</summary>

![고정 방법](https://user-images.githubusercontent.com/5153875/196175536-4df46097-dde7-48e2-9c8d-ca4b5c12a3ee.png)

</details>

- 설정에서 분대, 조합, 고정 오퍼레이터 등을 선택할 수 있습니다.
- 오퍼레이터와 레벨을 인식하고 오퍼레이터와 스킬의 최적의 조합을 찾습니다.
- 상점 아이템을 인식하고 가장 가치 있는 아이템을 구매합니다.
- 연결 끊김 이후의 자동 재연결과 오전 4시 이후의 리플레이를 지원합니다.
- 5분이 지나도 작전이 끝나지 않으면 모든 지상 오퍼레이터를 퇴각시킵니다. 6분이 지나면 작전을 포기하여 무한 루프의 가능성을 방지합니다.
- 버그에 영향을 받을 경우 탐험을 포기하고 재도전합니다. 특정 위치에서 반복적으로 이러한 현상이 발생하여 효율에 심각한 영향을 끼칠 경우, 이슈를 제출해 주세요.

### 전략 공유

[prts.plus](https://prts.plus)에서 전략을 공유할 수 있습니다!

#### 전략 불러오기

- `작전 개시` 버튼이 있는 화면에서 실행해 주세요.
- 지원 오퍼레이터 등이 필요하다면, `자동 편성`을 비활성화하고 직접 편성해 주세요.
- 유용한 전략에는 좋아요를 눌러주세요!

![image](https://user-images.githubusercontent.com/18511905/189662951-5f9d6d88-3c23-49b3-a58f-c35388b2d5d7.png)

#### 전략 생성

- 전략 생성 툴은 MAA 폴더 내에 제공되어 있습니다. [Copilot 자동전투 스키마](3.3-COPILOT_자동전투_스키마.md) 문서를 참조하세요.
- 맵 좌표를 확인하고 싶다면 `stage_name`를 입력하고 시작하면 폴더 내에 `map.png`가 생성될 것입니다. 또는 [PRTS.map](https://map.ark-nights.com/)에서 좌표 설정을 `MAA` 모드로 하고 확인하는 방법도 있습니다.
- 테스트를 위해서는 연습권 사용을 추천합니다.
- [prts.plus](https://prts.plus)에서 전략을 공유할 수 있습니다!
- 이름, 영상 링크, 그 외 도움이 될 만한 정보들을 설명에 적어주시는 것을 권장드립니다.

### 창고 인식(테스트 기능)

`육성 재료`를 선택한 후 인식을 시작해 주세요. 현재로서는 몇몇 데이터 웹사이트들로의 내보내기만이 지원됩니다. 더 많은 기능이 미래에 추가될 예정입니다.
다른 데이터 사이트를 운용 중이신 분이라면 해당 사이트의 JSON 형식을 적용할 수 있도록 연락해주셔도 좋습니다.

### 기타

- 작업 순서는 UI에서 드래그로 변경 가능합니다. 기반시설의 교체 순서도 그렇습니다.
- 대부분의 설정 변경사항은 자동으로 저장되나, *표가 붙은 설정은 제외입니다.
- 모든 클릭 이벤트는 푸아송 분포를 따라서 일정 범위 내 무작위로 시행됩니다. (중앙일수록 확률이 높고, 바깥일수록 낮습니다)
- 기본 알고리즘은 C++만을 이용해 개발되었으며, 다층 캐시 구조로 CPU와 메모리 사용량을 최소화하도록 설계되었습니다.
- 이 프로그램은 자동 업데이트가 지원됩니다 ✿✿ヽ(°▽°)ノ✿ 잦은 업데이트에 개의치 않는다면 베타 버전 사용을 추천드립니다. 업데이트가 빠르고 버그가 더 적습니다.
- 자동 업데이트가 실패한다면 파일을 직접 다운로드해서 ZIP 파일을 같은 폴더에 넣어주세요. 업데이트가 자동으로 시작될 것입니다.

## 다른 기능

만약 여러 개의 에뮬레이터를 동시에 활용하고자 한다면, MAA 폴더의 사본을 만든 다음, **같은 ADB 경로**와 **다른 ADB 주소**를 사용해 작업을 진행해 주세요.
