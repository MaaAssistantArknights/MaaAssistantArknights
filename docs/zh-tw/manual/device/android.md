---
order: 4
icon: mingcute:android-fill
---

# Android 實體設備

::: warning
此方法涉及 ADB 命令列，穩定性較低且仍需與電腦連線，**不推薦**零基礎玩家嘗試。
:::

::: info 注意

0. 需同時參考 [連線設定](../connection.md)。
1. 從 Android 10 開始，Minitouch 在 SELinux 為 `Enforcing` 模式時不再可用，請切換至其他觸控模式，或將 SELinux **臨時**切換為 `Permissive` 模式。
2. 由於 Android 生態極為複雜，可在 MAA `設定 - 連線設定` 中嘗試將 `連線配置` 修改為 `通用模式` 或 `相容模式` 或 `第二解析度` 或 `通用模式（屏蔽異常輸出）`，直到某個模式可以正常使用。
3. 由於 MAA 僅支援 `16:9` 比例的解析度，因此非 `16:9` 或 `9:16` 螢幕比例的設備需要強制修改解析度，這包含大多數現代設備。若被連線設備螢幕解析度比例原生為 `16:9` 或 `9:16`，則可跳過 `更改解析度` 部分。
4. 請將設備導覽方式切換為除 `全螢幕手勢` 以外的方式，如 `經典導覽鍵` 等以避免誤操作。
5. 請將遊戲內設定中的 `螢幕 UI 調整` 該項數值調整為 0 以避免任務出錯。

:::

::: tip
典型的 `16:9` 比例解析度有 `3840*2160` (4K)、`2560*1440` (2K)、`1920*1080` (1080P)、`1280*720` (720P)。
:::

## 下載、執行 ADB 除錯工具並連線設備

1. 下載 [ADB](https://dl.google.com/android/repository/platform-tools-latest-windows.zip) 並解壓縮。
2. 開啟解壓縮後的資料夾，清空位址列並輸入 `cmd` 後按下 Enter。
3. 在彈出的命令提示字元視窗中輸入 `adb`，若出現大量英文說明文字則表示執行成功。
4. 手機開啟 `USB 除錯`。每個品牌手機的開啟路徑可能不同，請善用搜尋引擎。廠商可能會提供有關 USB 除錯的額外選項，例如 MIUI 中的 `USB 安裝` 和 `USB 除錯（安全設定）`，請同時開啟。
5. 將手機透過傳輸線連線至電腦，在剛才的命令提示字元視窗中輸入以下指令：

   ```bash
   adb devices
   ```

- 成功執行後會顯示已連線 `USB 除錯` 設備的資訊。
  - 連線成功的例子：

    ```bash
    List of devices attached
    VFNDU1682100xxxx        device
    ```

  - **`device` 前的英數字組合為設備序號，同時也作為 MAA 的 `連線位址`。**

- 現代 Android 設備進行 `USB 除錯` 需在被除錯設備上點選彈窗授權，若未授權則例子如下：

  ```bash
  List of devices attached
  VFNDU1682100xxxx        unauthorized
  ```

- 若無論如何都提示未授權或設備序號後顯示 `offline`，則需重啟設備及電腦後重試。如仍未解決問題，可刪除目前使用者個人資料夾下的 `.android` 資料夾並再次重啟後重試，具體位置請自行搜尋。

## 更改解析度

::: tip
手機螢幕解析度為 `短邊*長邊`，而非電腦顯示器的 `長邊*短邊`。具體數值請根據目標設備自行確定。
:::

- 如果上文設備列表內僅有一台設備，則可直接執行以下指令更改 / 還原解析度。

  ```bash
  # 查看目前解析度
  adb shell wm size
  # 還原預設解析度
  adb shell wm size reset

  # 更改解析度為 720p
  adb shell wm size 720x1280
  # 更改解析度為 1080p
  adb shell wm size 1080x1920
  ```

- 若存在多台設備，則需在 `adb` 和 `shell` 中間加上參數 `-s <目標設備序號>`，範例如下：

  ```bash
  # 查看目前解析度
  adb -s VFNDU1682100xxxx shell wm size
  # 還原預設解析度
  adb -s VFNDU1682100xxxx shell wm size reset

  # 更改解析度為 720p
  adb -s VFNDU1682100xxxx shell wm size 720x1280
  # 更改解析度為 1080p
  adb -s VFNDU1682100xxxx shell wm size 1080x1920
  ```

- 部分設計不規範的應用程式可能在還原解析度後內容佈局仍然錯亂，一般重啟對應應用程式或設備即可解決。

::: danger 注意
強烈建議在**下次重啟設備前**還原解析度，否則依設備而定可能會導致不可預料的後果，~~包括但不限於佈局混亂、觸控錯位、應用程式閃退、無法解鎖等~~。
:::

::: danger 注意

已知在部分實體設備上 `帳號切換` 功能可能無法正常運作。MAA 主要在電腦端模擬器環境運作，因此並無計畫修復該問題。

如果您遇到這個問題，可以透過以下任意一種方式修改螢幕密度 (DPI)（建議取值為 `[100-800]`）：

- 使用指令 `adb shell wm density <DPI>` 直接修改 DPI
- 調整 `開發者選項 → 最小寬度`，透過修改 `最小寬度` 間接修改 DPI

  備註：`DPI` 和 `最小寬度` 成反比，換算關係為 `最小寬度 = 螢幕寬度(px) / (DPI / 160)`

**請注意該操作存在風險，可能使設備運作異常。請確保您知道自己在做什麼，設備故障後果自負。**

強烈建議在**下次重啟設備前**還原這些更改。若忘記預設值，無論使用何種方式修改，均可使用指令 `adb shell wm density reset` 還原。

:::

## 自動化更改解析度

1. 在 MAA 目錄下新建兩個文字檔案，分別在其中填入以下內容：

   ```bash
   # 調整解析度為 1080p
   adb -s <目標設備序號> shell wm size 1080x1920
   # 降低螢幕亮度（選填）
   adb -s <目標設備序號> shell settings put system screen_brightness 1
   ```

   ```bash
   # 還原解析度
   adb -s <目標設備序號> shell wm size reset
   # 提高螢幕亮度（選填）
   adb -s <目標設備序號> shell settings put system screen_brightness 20
   # 返回桌面（選填）
   adb -s <目標設備序號> shell input keyevent 3
   # 鎖定螢幕（選填）
   adb -s <目標設備序號> shell input keyevent 26
   ```

2. 將第一個檔案重新命名為 `startup.bat`，第二個檔案重新命名為 `finish.bat`。
   - 如果重新命名後沒有彈出修改副檔名的確認對話框，且檔案圖示沒有變化，請自行搜尋「Windows 如何顯示檔案副檔名」。

3. 在 MAA 的 `設定 - 連線設定 - 開始前腳本` 和 `結束後腳本` 中分別填入 `startup.bat` 和 `finish.bat`。

## 連線 MAA

### 有線連線

::: tip
使用有線連線不需要任何 IP 位址或連接埠，只需要 `adb devices` 提供的設備序號。
:::

1. 將上文獲取到的目標設備序號填入 MAA `設定 - 連線設定 - 連線位址` 中。
2. Link Start!

### 無線連線

- 請確保設備與電腦處在同一區域網路環境下且能互相通訊。諸如 `AP 隔離`、`訪客網路` 等設定會阻止設備間通訊，具體請查閱對應路由器文件。
- 無線除錯在設備重啟後會失效，需要重新設定。

#### 使用 `adb tcpip` 開啟無線連接埠

1. 在剛才的命令提示字元視窗中輸入以下指令以開啟無線除錯：

   ```bash
   adb tcpip 5555
   # 存在多台設備則新增參數 -s 以指定序號
   ```

2. 查看設備 IP 位址
   - 進入手機 `設定 - WLAN`，點選目前已連線的無線網路查看 IP 位址。
   - 各品牌設備設定位置不同，請自行查找。

3. 將 `<IP>:5555` 填入 MAA `設定 - 連線設定 - 連線位址` 中，例如 `192.168.1.2:5555`。

4. Link Start!

#### 使用 `adb pair` 開啟無線連接埠

::: tip
`adb pair` 無線配對，即使用 Android 11 及更新版本中開發者選項內的 `無線偵錯` 進行配對後連線，與 `adb tcpip` 相比可以避免有線連線。
:::

1. 進入手機開發者選項，點選 `無線偵錯` 並開啟，點選確定，點選 `使用配對碼配對設備`，在配對完成前不要關閉出現的彈窗。

2. 進行配對。
   1. 在命令提示字元中輸入 `adb pair <設備彈窗提供的 IP 位址和連接埠>`，按下 Enter。
   2. 輸入 `<設備彈窗提供的六位配對碼>`，按下 Enter。
   3. 視窗出現 `Successfully paired to <IP:連接埠>` 等內容，同時設備上的彈窗自動消失，底部已配對的設備中出現電腦名稱。

3. 將目前設備螢幕上顯示的 <`IP 位址和連接埠>` 填入 MAA `設定 - 連線設定 - 連線位址` 中，例如 `192.168.1.2:11451`，請注意**一定與剛才填寫的位址不同**。

4. Link Start!

#### 使用 root 權限開啟無線連接埠

~~都接觸到 Root 了還需要看這段文件嗎~~

1. 下載、安裝 [WADB](https://github.com/RikkaApps/WADB/releases) 並授予其 Root 權限。
2. 開啟 WADB，啟動無線 ADB。
3. 將 WADB 提供的 IP 位址及連接埠填入 MAA `設定 - 連線設定 - 連線位址` 中，例如 `192.168.1.2:5555`。
4. Link Start!
