import{_ as a,c as o,b as t,o as l}from"./app-BJyjtOXl.js";const r={};function i(p,e){return l(),o("div",null,[...e[0]||(e[0]=[t('<p>MAA 藉由 GitHub Actions 完成了大量的自動化工作，包括網站建置、資源自動更新、最終檔案的編譯與發布等過程。隨著時間推移，這些 CI 逐漸開始嵌套，部分甚至連結到了其他的倉庫。本文檔旨在為想要改進 MAA CI 系統的開發者提供一份簡要介紹。</p><p>閱讀本文之前，建議先對 MAA 的專案結構與組成有基本的概念。</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>您可以透過在本頁面內搜尋 CI 檔名來快速導航到想看的內容。</p></div><p>工作流（Workflow）檔案均存放於 <code>.github/workflows</code> 目錄下，各檔案可依功能分為以下幾部分：</p><ul><li><a href="#%E7%A8%8B%E5%BC%8F%E7%A2%BC%E6%B8%AC%E8%A9%A6">程式碼測試</a></li><li><a href="#%E7%A8%8B%E5%BC%8F%E7%A2%BC%E5%BB%BA%E7%BD%AE">程式碼建置</a></li><li><a href="#%E7%A8%8B%E5%BC%8F%E7%A2%BC%E5%AE%89%E5%85%A8%E6%AA%A2%E6%9F%A5">程式碼安全檢查</a></li><li><a href="#%E7%89%88%E6%9C%AC%E7%99%BC%E5%B8%83">版本發布</a></li><li><a href="#%E8%B3%87%E6%BA%90%E6%9B%B4%E6%96%B0">資源更新</a></li><li><a href="#%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE">網站建置</a></li><li><a href="#issues-%E7%AE%A1%E7%90%86">Issues 管理</a></li><li><a href="#pull-requests-%E7%AE%A1%E7%90%86">Pull Requests 管理</a></li><li><a href="#mirrorchyan-%E7%9B%B8%E9%97%9C">MirrorChyan 相關</a></li><li><a href="#%E5%85%B6%E4%BB%96">其他</a></li></ul><p>此外，我們還透過 <a href="https://pre-commit.ci/" target="_blank" rel="noopener noreferrer">pre-commit.ci</a> 實現了程式碼自動格式化與圖片資源自動優化，它在發起 PR 後會自動執行，一般無需特別在意。</p><h2 id="github-actions-部分" tabindex="-1"><a class="header-anchor" href="#github-actions-部分"><span>GitHub Actions 部分</span></a></h2><h3 id="程式碼測試" tabindex="-1"><a class="header-anchor" href="#程式碼測試"><span>程式碼測試</span></a></h3><p><code>smoke-testing.yml</code></p><p>本工作流主要負責對 MaaCore 進行基礎檢測，包括資源檔案載入、部分簡單任務（Task）執行測試等。</p><p>由於測試案例（Test Cases）已較久未更新，該工作流目前的初衷是確保資源檔案不會出錯，以及 MaaCore 的程式碼沒有出現影響建置的致命性錯誤。</p><h3 id="程式碼建置" tabindex="-1"><a class="header-anchor" href="#程式碼建置"><span>程式碼建置</span></a></h3><p><code>ci.yml</code></p><p>本工作流負責對程式碼進行全量建置工作，包含 MAA 的所有組件，建置產物即為可執行的 MAA。</p><p>除了必要的 MaaCore 外，Windows 建置產物會包含 MaaWpfGui，macOS 建置產物會包含 MaaMacGui，Linux 建置產物則包含 MaaCLI。</p><p>該工作流在有任何新提交（Commit）或 PR 時都會自動執行；當該工作流由發版 PR 觸發時，本次的建置產物將直接用於發布，並自動建立一個 Release。</p><h3 id="程式碼安全檢查" tabindex="-1"><a class="header-anchor" href="#程式碼安全檢查"><span>程式碼安全檢查</span></a></h3><p>程式碼安全檢查透過 CodeQL 對程式碼與工作流進行安全分析，具體工作流如下：</p><p><code>codeql-core.yml</code></p><p>負責對 MaaCore 與 MaaWpfGui 的 C++ 和 C# 程式碼進行安全分析，偵測潛在的安全漏洞。</p><p>該工作流在修改相關原始碼的 PR 時會自動執行，同時於每天 UTC 時間 11:45 進行定期檢查。</p><p><code>codeql-wf.yml</code></p><p>負責對 GitHub Actions 工作流檔案本身進行安全分析，確保 CI/CD 流程的安全性。</p><p>該工作流在修改工作流檔案的 PR 時會自動執行，同時於每天 UTC 時間 12:00 進行定期檢查。</p><h3 id="版本發布" tabindex="-1"><a class="header-anchor" href="#版本發布"><span>版本發布</span></a></h3><p>版本發布（簡稱發版）是向用戶發布更新的必要操作，由以下工作流組成：</p><ul><li><code>release-nightly-ota.yml</code> 發布內測版（Nightly）</li><li><code>release-ota.yml</code> 發布正式版 / 公測版（Beta） <ul><li><code>release-preparation.yml</code> 為正式版 / 公測版產生 Changelog 並準備發布</li><li><code>pr-auto-tag.yml</code> 對正式版 / 公測版產生 Tag</li></ul></li></ul><div class="hint-container tip"><p class="hint-container-title">提示</p><p>上述檔名稱內的 OTA 意為 Over-the-Air（雲端更新），也就是我們常說的 <code>增量更新檔案</code>，因此 MAA 的發版過程實際上包含了對過往版本建置 OTA 檔案的步驟。</p></div><h4 id="內測版" tabindex="-1"><a class="header-anchor" href="#內測版"><span>內測版</span></a></h4><p><code>release-nightly-ota.yml</code></p><p>本工作流會在每天 UTC 時間 22 點自動執行，以保證內測版的更新頻率。當然，您也可以在做出更改需要驗證時手動觸發發布。</p><p>需要注意的是，內測版發布僅針對 Windows 用戶，macOS 與 Linux 用戶目前無法接收到內測更新。</p><h4 id="正式版-公測版" tabindex="-1"><a class="header-anchor" href="#正式版-公測版"><span>正式版 / 公測版</span></a></h4><p>這兩個版本的發布流程相對複雜，我們透過模擬一次發布步驟來解釋各工作流的作用：</p><ol><li>建立從 <code>dev</code> 到 <code>master</code> 分支的 PR，且該 PR 的標題需為 <code>Release v******</code>。</li><li><code>release-preparation.yml</code> 會產生從最近版本到當前版本的 Changelog（以一個新 PR 的形式呈現）。</li><li>對 Changelog 進行手動調整，並加入簡要描述。</li><li>合併 PR，觸發 <code>pr-auto-tag.yml</code> 建立 Tag 並同步分支。</li><li>Release 事件觸發 <code>release-ota.yml</code>，對 master 標上 Tag 後進行 OTA 包建置及附件上傳。</li></ol><h3 id="資源更新" tabindex="-1"><a class="header-anchor" href="#資源更新"><span>資源更新</span></a></h3><p>這部分工作流主要負責 MAA 的資源更新與優化，具體如下：</p><ul><li><code>res-update-game.yml</code> 定期執行，從指定倉庫拉取遊戲資源。</li><li><code>sync-resource.yml</code> 將資源同步到 MaaResource 倉庫，用於資源更新。</li><li><code>optimize-templates.yml</code> 優化包括範本圖片在內的圖片檔案大小。</li></ul><h3 id="網站建置" tabindex="-1"><a class="header-anchor" href="#網站建置"><span>網站建置</span></a></h3><p><code>website-workflow.yml</code></p><p>本工作流主要負責 MAA 文件站的建置與發布。</p><p>請注意，網站的發布與版本更新強烈綁定。平時修改網頁組件時僅會進行建置以確保無誤，只有在正式發布版本時才會部署到 GitHub Pages。</p><h3 id="issues-管理" tabindex="-1"><a class="header-anchor" href="#issues-管理"><span>Issues 管理</span></a></h3><p><code>issue-checker.yml</code></p><p>透過正規表達式（Regex）比對為各個 Issue 標記 Tag，以此分類 Issue 內容，方便查看與管理。</p><p><code>issue-checkbox-checker.yml</code></p><p>透過正規表達式自動關閉勾選「我未仔細閱讀」的 Issue；若該項未被勾選，則將所有勾選框（Checkbox）折疊。</p><p><code>stale.yml</code></p><p>檢查超過 90 天沒有活動的 Bug Issue 並標記通知，若 7 天後仍無活動則自動關閉。</p><h3 id="pull-requests-管理" tabindex="-1"><a class="header-anchor" href="#pull-requests-管理"><span>Pull Requests 管理</span></a></h3><p><code>pr-checker.yml</code></p><p>檢查 PR 中的 Commit Message 是否符合 <a href="https://www.conventionalcommits.org/zh-hans/v1.0.0/" target="_blank" rel="noopener noreferrer">約定式提交</a>，以及是否包含 Merge Commit，若不符合則會發出提示。</p><h3 id="mirrorchyan-相關" tabindex="-1"><a class="header-anchor" href="#mirrorchyan-相關"><span>MirrorChyan 相關</span></a></h3><p>MirrorChyan 是有償的更新鏡像服務，相關工作流如下：</p><ul><li><code>release-package-distribution.yml</code> 同步更新包至 MirrorChyan。</li><li><code>mirrorchyan_release_note.yml</code> 產生 MirrorChyan 的 Release Note。</li></ul><h3 id="其他" tabindex="-1"><a class="header-anchor" href="#其他"><span>其他</span></a></h3><p><code>markdown-checker.yml</code></p><p>檢查倉庫中所有 Markdown 檔案是否包含無效連結（死連結）。</p><p><code>blame-ignore.yml</code></p><p>自動忽略 Commit Message 包含 <code>blame ignore</code> 的提交，以保持 Git Blame 歷史紀錄的簡潔。</p><p><code>cache-delete.yml</code></p><p>在 PR 合併後清理相關快取（Cache），以節省 GitHub 儲存空間。</p><p><code>update-submodules.yml</code></p><p>定期將 MaaMacGui 與 maa-cli 等子模組更新至最新版本。該工作流於每天 UTC 時間 21:50 自動執行（在每日內測版發布之前），確保子模組保持在最新狀態。</p>',64)])])}const s=a(r,[["render",i]]),n=JSON.parse('{"path":"/zh-tw/develop/ci-tutorial.html","title":"CI 系統解析","lang":"zh-TW","frontmatter":{"order":7,"icon":"devicon-plain:githubactions","title":"CI 系統解析","description":"MAA 藉由 GitHub Actions 完成了大量的自動化工作，包括網站建置、資源自動更新、最終檔案的編譯與發布等過程。隨著時間推移，這些 CI 逐漸開始嵌套，部分甚至連結到了其他的倉庫。本文檔旨在為想要改進 MAA CI 系統的開發者提供一份簡要介紹。 閱讀本文之前，建議先對 MAA 的專案結構與組成有基本的概念。 提示 您可以透過在本頁面內搜尋...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"CI 系統解析\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://docs.maa.plus/zh-tw/develop/ci-tutorial.html"}],["meta",{"property":"og:site_name","content":"MAA 文件站"}],["meta",{"property":"og:title","content":"CI 系統解析"}],["meta",{"property":"og:description","content":"MAA 藉由 GitHub Actions 完成了大量的自動化工作，包括網站建置、資源自動更新、最終檔案的編譯與發布等過程。隨著時間推移，這些 CI 逐漸開始嵌套，部分甚至連結到了其他的倉庫。本文檔旨在為想要改進 MAA CI 系統的開發者提供一份簡要介紹。 閱讀本文之前，建議先對 MAA 的專案結構與組成有基本的概念。 提示 您可以透過在本頁面內搜尋..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-TW"}],["meta",{"property":"og:locale:alternate","content":"ko-KR"}],["meta",{"property":"og:locale:alternate","content":"ja-JP"}],["meta",{"property":"og:locale:alternate","content":"en-US"}],["meta",{"property":"og:locale:alternate","content":"zh-CN"}],["link",{"rel":"alternate","hreflang":"ko-kr","href":"https://docs.maa.plus/ko-kr/develop/ci-tutorial.html"}],["link",{"rel":"alternate","hreflang":"ja-jp","href":"https://docs.maa.plus/ja-jp/develop/ci-tutorial.html"}],["link",{"rel":"alternate","hreflang":"en-us","href":"https://docs.maa.plus/en-us/develop/ci-tutorial.html"}],["link",{"rel":"alternate","hreflang":"zh-cn","href":"https://docs.maa.plus/zh-cn/develop/ci-tutorial.html"}]]},"readingTime":{"minutes":5.29,"words":1587},"git":{"createdTime":1772016062000},"autoDesc":true,"filePathRelative":"zh-tw/develop/ci-tutorial.md","headers":[]}');export{s as comp,n as data};
